-- @description query01 for PXF HDFS Readable images
SELECT image_test_one_file_per_fragment_streaming_fragments.names, image_test_one_file_per_fragment_streaming_fragments.directories, image_test_one_file_per_fragment_streaming_fragments.one_hot_encodings FROM image_test_one_file_per_fragment_streaming_fragments, compare_table_one_file_per_fragment_streaming_fragments
    WHERE image_test_one_file_per_fragment_streaming_fragments.fullpaths             = compare_table_one_file_per_fragment_streaming_fragments.fullpaths
    AND image_test_one_file_per_fragment_streaming_fragments.names                   = compare_table_one_file_per_fragment_streaming_fragments.names
    AND image_test_one_file_per_fragment_streaming_fragments.directories             = compare_table_one_file_per_fragment_streaming_fragments.directories
    AND image_test_one_file_per_fragment_streaming_fragments.one_hot_encodings       = compare_table_one_file_per_fragment_streaming_fragments.one_hot_encodings
    AND image_test_one_file_per_fragment_streaming_fragments.dimensions              = compare_table_one_file_per_fragment_streaming_fragments.dimensions
    AND image_test_one_file_per_fragment_streaming_fragments.images                  = compare_table_one_file_per_fragment_streaming_fragments.images
    ORDER BY names, directories;
 names  |    directories     | one_hot_encodings
--------+--------------------+-------------------
 0.png  | readableImages     | {0,0,0,1}
 1.png  | readableImages     | {0,0,0,1}
 10.png | deeply_nested_dir1 | {1,0,0,0}
 11.png | deeply_nested_dir1 | {1,0,0,0}
 12.png | deeply_nested_dir1 | {1,0,0,0}
 13.png | deeply_nested_dir1 | {1,0,0,0}
 14.png | deeply_nested_dir1 | {1,0,0,0}
 15.png | nested_dir         | {0,0,1,0}
 16.png | nested_dir         | {0,0,1,0}
 17.png | nested_dir         | {0,0,1,0}
 18.png | nested_dir         | {0,0,1,0}
 19.png | nested_dir         | {0,0,1,0}
 2.png  | readableImages     | {0,0,0,1}
 3.png  | readableImages     | {0,0,0,1}
 4.png  | readableImages     | {0,0,0,1}
 5.png  | deeply_nested_dir2 | {0,1,0,0}
 6.png  | deeply_nested_dir2 | {0,1,0,0}
 7.png  | deeply_nested_dir2 | {0,1,0,0}
 8.png  | deeply_nested_dir2 | {0,1,0,0}
 9.png  | deeply_nested_dir2 | {0,1,0,0}
(20 rows)

SELECT image_test_one_file_per_fragment_streaming_fragments_bytea.names, image_test_one_file_per_fragment_streaming_fragments_bytea.directories, image_test_one_file_per_fragment_streaming_fragments_bytea.one_hot_encodings FROM image_test_one_file_per_fragment_streaming_fragments_bytea, compare_table_one_file_per_fragment_streaming_fragments_bytea
    WHERE image_test_one_file_per_fragment_streaming_fragments_bytea.fullpaths       = compare_table_one_file_per_fragment_streaming_fragments_bytea.fullpaths
    AND image_test_one_file_per_fragment_streaming_fragments_bytea.names             = compare_table_one_file_per_fragment_streaming_fragments_bytea.names
    AND image_test_one_file_per_fragment_streaming_fragments_bytea.directories       = compare_table_one_file_per_fragment_streaming_fragments_bytea.directories
    AND image_test_one_file_per_fragment_streaming_fragments_bytea.one_hot_encodings = compare_table_one_file_per_fragment_streaming_fragments_bytea.one_hot_encodings
    AND image_test_one_file_per_fragment_streaming_fragments_bytea.dimensions        = compare_table_one_file_per_fragment_streaming_fragments_bytea.dimensions
    AND image_test_one_file_per_fragment_streaming_fragments_bytea.images            = compare_table_one_file_per_fragment_streaming_fragments_bytea.images
    ORDER BY names, directories;
 names  |    directories     | one_hot_encodings
--------+--------------------+-------------------
 0.png  | readableImages     | {0,0,0,1}
 1.png  | readableImages     | {0,0,0,1}
 10.png | deeply_nested_dir1 | {1,0,0,0}
 11.png | deeply_nested_dir1 | {1,0,0,0}
 12.png | deeply_nested_dir1 | {1,0,0,0}
 13.png | deeply_nested_dir1 | {1,0,0,0}
 14.png | deeply_nested_dir1 | {1,0,0,0}
 15.png | nested_dir         | {0,0,1,0}
 16.png | nested_dir         | {0,0,1,0}
 17.png | nested_dir         | {0,0,1,0}
 18.png | nested_dir         | {0,0,1,0}
 19.png | nested_dir         | {0,0,1,0}
 2.png  | readableImages     | {0,0,0,1}
 3.png  | readableImages     | {0,0,0,1}
 4.png  | readableImages     | {0,0,0,1}
 5.png  | deeply_nested_dir2 | {0,1,0,0}
 6.png  | deeply_nested_dir2 | {0,1,0,0}
 7.png  | deeply_nested_dir2 | {0,1,0,0}
 8.png  | deeply_nested_dir2 | {0,1,0,0}
 9.png  | deeply_nested_dir2 | {0,1,0,0}
(20 rows)

